$(document).ready(()=>{function e(n){var t=$(window).scrollTop(),r=t+$(window).height(),i=$(n).offset().top,u=i+$(n).height();return u<=r&&i>=t}function t(n,t){var i=n.find(".error-wrapper"),r=i.find(".error-message");r.html(t);i.removeClass("hidden")}function i(n,t){var i=n.find(".info-wrapper"),r=i.find(".info-message");r.html(t);i.removeClass("hidden")}function r(n){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(n)}function u(n,t){n.find("input").prop("disabled",t);n.find("textarea").prop("disabled",t);n.find("button").prop("disabled",t)}function o(n){n.find("input").val("");n.find("textarea").val("");n.find("button").val("")}function f(t){if(n.SomethingHappened){t();return}$.ajax({url:"Subscribe/GetRequiredResources",type:"GET"}).success(function(i){n.SomethingHappened=i.somethingHappened;n.EnterValidEmail=i.enterValidEmail;n.ErrorOccurred=i.errorOccurred;n.EmailSuccessfullyRegistered=i.emailSuccessfullyRegistered;t()})}var n={SomethingHappened:"",EnterValidEmail:"",ErrorOccurred:"",EmailSuccessfullyRegistered:""};$("#shop-button").click(()=>{window.location.href="/Contact"});$(".garvan-story-button").click(()=>{window.location.href="/Story"});$(".chapter-link").on("click",function(n){if(n.preventDefault(),this.hash!==""){var t=this.hash;$("html, body").animate({scrollTop:$(t).offset().top-120},800)}});$(window).scroll(function(){var i,n,t,r;for($(".chapter-nav-link").removeClass("selected-chapter"),i=$(".chapter-nav-link"),n=0;n<i.length;n++)if((t=i[n].hash,t)&&(r=e(t),r)){$(".chapter-nav-link[href='"+t+"']").addClass("selected-chapter");return}});$(".subscribe-register-form").on("submit",function(u){u.preventDefault();f(()=>{var u=$(this).closest("#subscribe-div"),e=u.find(".email-subscribe-input"),f,o;if(!e){t(u,n.SomethingHappened);return}if(f=e.val(),!f||!r(f)){t(u,n.EnterValidEmail);return}o=u.find(".loading-wrapper");o.removeClass("hidden");$.ajax({type:"POST",url:"/Subscribe/AddEmail",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify(f),dataType:"json",error:function(){t(u,n.ErrorOccurred)},success:function(r){r!=null&&r.success?(i(u,n.EmailSuccessfullyRegistered),e.val("")):t(u,r.responseText)}}).always(function(){o.addClass("hidden")})})});$(".error-close-button").click(function(){var n=$(this).closest(".error-wrapper");n.addClass("hidden")});$(".info-close-button").click(function(){var n=$(this).closest(".info-wrapper");n.addClass("hidden")});$("#garvan-contact-form").submit(function(e){e.preventDefault();var s=$(this);f(()=>{var f=s.closest("div"),h=s.find("#contactEmailInput").val(),e;if(!h||!r(h)){t(f,n.EnterValidEmail);return}var l=JSON.stringify(s.serialize()),c=s.serialize();u(s,!0);e=f.find(".loading-wrapper");e.removeClass("hidden");$.ajax({url:"Contact/SendEmail",type:"POST",contentType:"application/x-www-form-urlencoded; charset=utf-8",dataType:"json",data:c}).done(function(n){n!=null&&n.success?(i(f,n.responseText),o(s)):t(f,n.responseText);u(s,!1);e.addClass("hidden")})})})});