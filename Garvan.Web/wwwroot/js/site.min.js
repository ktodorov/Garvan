$(document).ready(()=>{function o(n){var t=$(window).scrollTop(),r=t+$(window).height(),i=$(n).offset().top,u=i+$(n).height();return u<=r&&i>=t}function t(n,t){var i=n.find(".error-wrapper"),r=i.find(".error-message");r.html(t);i.removeClass("hidden")}function r(n,t){var i=n.find(".info-wrapper"),r=i.find(".info-message");r.html(t);i.removeClass("hidden")}function u(n){return/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(n)}function s(n){var i=n.serializeArray(),t={};return $.map(i,function(n){t[n.name]=n.value}),t}function i(n,t){n.find("input").prop("disabled",t);n.find("textarea").prop("disabled",t);n.find("button").prop("disabled",t)}function e(n){n.find("input").val("");n.find("textarea").val("");n.find("button").val("")}function f(t){if(n.SomethingHappened){t();return}$.ajax({url:"Subscribe/GetRequiredResources",type:"GET"}).success(function(i){n.SomethingHappened=i.somethingHappened;n.EnterValidEmail=i.enterValidEmail;n.EnterValidCount=i.enterValidCount;n.ErrorOccurred=i.errorOccurred;n.EmailSuccessfullyRegistered=i.emailSuccessfullyRegistered;t()})}var n={SomethingHappened:"",EnterValidEmail:"",ErrorOccurred:"",EmailSuccessfullyRegistered:"",EnterValidCount:""};$("#shop-button").click(()=>{window.location.href="/Contact"});$(".garvan-story-button").click(()=>{window.location.href="/Story"});$(".chapter-link").on("click",function(n){if(n.preventDefault(),this.hash!==""){var t=this.hash;$("html, body").animate({scrollTop:$(t).offset().top-120},800)}});$(window).scroll(function(){var i,n,t,r;for($(".chapter-nav-link").removeClass("selected-chapter"),i=$(".chapter-nav-link"),n=0;n<i.length;n++)if((t=i[n].hash,t)&&(r=o(t),r)){$(".chapter-nav-link[href='"+t+"']").addClass("selected-chapter");return}});$(".subscribe-register-form").on("submit",function(i){i.preventDefault();f(()=>{var i=$(this).closest("#subscribe-div"),e=i.find(".email-subscribe-input"),f,o;if(!e){t(i,n.SomethingHappened);return}if(f=e.val(),!f||!u(f)){t(i,n.EnterValidEmail);return}o=i.find(".loading-wrapper");o.removeClass("hidden");$.ajax({type:"POST",url:"/Subscribe/AddEmail",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify(f),dataType:"json",error:function(){t(i,n.ErrorOccurred)},success:function(u){u!=null&&u.success?(r(i,n.EmailSuccessfullyRegistered),e.val("")):t(i,u.responseText)}}).always(function(){o.addClass("hidden")})})});$(".error-close-button").click(function(){var n=$(this).closest(".error-wrapper");n.addClass("hidden")});$(".info-close-button").click(function(){var n=$(this).closest(".info-wrapper");n.addClass("hidden")});$("#garvan-contact-form").submit(function(o){o.preventDefault();var s=$(this);f(()=>{var f=s.closest("div"),h=s.find("#contactEmailInput").val(),c,l,o;if(!h||!u(h)){t(f,n.EnterValidEmail);return}c="application/x-www-form-urlencoded; charset=utf-8";l=s.serialize();i(s,!0);o=f.find(".loading-wrapper");o.removeClass("hidden");$.ajax({url:"Contact/SendEmail",type:"POST",contentType:c,dataType:"json",data:l}).done(function(n){n!=null&&n.success?(r(f,n.responseText),e(s)):t(f,n.responseText);i(s,!1);o.addClass("hidden")})})});$("#garvan-shop-form").submit(function(o){o.preventDefault();var h=$(this);f(()=>{var f=h.closest("div"),v=h.find("#shopEmailInput").val(),c,l,a;if(!v||!u(v)){t(f,n.EnterValidEmail);return}if(c=h.find("#shopCountInput").val(),!c){t(f,n.EnterValidCount);return}if(l=parseInt(c,10),l<0){t(f,n.EnterValidCount);return}var y=h.find(".shop-item-header").text().trim(),p=parseInt(h.find(".shop-object-price-current").text().trim()),o=s(h),w={name:o.name,email:o.email,shopObjects:[{count:l,name:y,price:p}],subject:o.subject,message:o.message,"recaptcha-response":o["g-recaptcha-response"]};i(h,!0);a=f.find(".loading-wrapper");a.removeClass("hidden");$.ajax({url:"Shop/SendBasketEmail",type:"POST",contentType:"application/json",dataType:"json",data:JSON.stringify(w)}).done(function(n){n!=null&&n.success?(r(f,n.responseText),e(h)):t(f,n.responseText);i(h,!1);a.addClass("hidden")})})})});